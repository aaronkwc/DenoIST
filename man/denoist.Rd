% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/denoist.R
\name{denoist}
\alias{denoist}
\title{DenoIST}
\usage{
denoist(
  mat,
  tx,
  coords = NULL,
  distance = 50,
  nbins = 200,
  cl = 1,
  out_dir = NULL
)
}
\arguments{
\item{mat}{A matrix of counts (genes x cells), or a SpatialExperiment object.}

\item{tx}{A data frame of transcript coordinates (transcripts x 2).}

\item{coords}{A data frame of coordinates (cells x 2).}

\item{distance}{The maximum distance to consider for local background estimation.}

\item{nbins}{The number of bins to use for hexagonal binning.}

\item{cl}{The number of cores to use for parallel processing.}

\item{out_dir}{The output directory to save the results.}
}
\value{
A list containing the following elements:
\item{memberships}{A matrix of memberships for each gene in each cell.}
\item{adjusted_counts}{A matrix of adjusted counts for each gene in each cell.}
\item{params}{A list of parameters for each gene.}
}
\description{
DenoIST (Denoising Image-based Spatial Transcriptomics) is a method for
identifying and removing contamination artefacts in
image-based single-cell transcriptomics (IST) data.
It uses a transposed Poisson mixture model to identify contamination.
}
\details{
The function calculates local background using hexagonal binning and applies
a Poisson mixture model to identify contamination.
It returns a matrix of memberships and adjusted counts for each gene in each cell.
}
\examples{
# Load example data
mat <- matrix(rpois(1000, lambda = 5), nrow = 10, ncol = 100)
coords <- data.frame(x = runif(100), y = runif(100))
tx <- data.frame(x = runif(100), y = runif(100), qv = runif(100, 0, 1))
# Run DenoIST
result <- denoist(mat, coords, tx, distance = 50, nbins = 200, cl = 8, out_dir = "denoist_results")
# Check results
print(result$memberships)
print(result$adjusted_counts)
print(result$params)
}
